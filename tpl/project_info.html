<script type="text/javascript" src="js/tabs.js"></script>

<div id="content">
   {if $projects}
   <div class="center">
      <form name="projectForm" method="get" action="{$page}">
         <fieldset>
            {include file="form/projectSelector.html"}
            <input type="submit" value="{t}Jump{/t}" />
         </fieldset>
      </form>
   </div>
   {/if}
   {if $versionsOverview || $versionsDetailedMgr || $versionsDetailed || $versionsIssues}
   <h3>{t}Project Versions{/t}</h3>
   <div id="tabsVersions" class="tabs">
      <ul>
         <li><a href="#tabVersionsDetailedMgr">{t}Detailed Mgr{/t}</a></li>
         <li><a href="#tabVersionsDetailed">{t}Detailed{/t}</a></li>
         <li><a href="#tabVersionsOverview">{t}Overview{/t}</a></li>
         <li><a href="#tabVersionsIssues">{t}Tasks{/t}</a></li>
      </ul>
      <div id="tabVersionsOverview">
         {if $versionsOverview}
         <table>
            <tr>
               <th>{t}Target version{/t}</th>
               <th>{t}Date{/t}</th>
               <th>{t}Progress Mgr{/t}</th>
               <th>{t}Progress{/t}</th>
               <th style="width: 80px;">{t}Drift Mgr{/t}</th>
               <th style="width: 80px;">{t}Drift{/t}</th>
            </tr>
            {foreach from=$versionsOverview key=name item=i name=versionsOverview}
            <tr {if $smarty.foreach.versionsOverview.last}class="row_total"{/if}>
               <td>{$i.name}</td>
               <td>{$i.date}</td>
               <td>{$i.progressMgr}%</td>
               <td>{$i.progress}%</td>
               <td {$i.driftMgrColor}>{$i.driftMgr}%</td>
               <td {$i.driftColor}>{$i.drift}%</td>
            </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsDetailedMgr">
         {if $versionsDetailedMgr}
         <table>
            <tr>
               <th>{t}Target version{/t}</th>
               <th>{t}MgrEffortEstim{/t}</th>
               <th title="backlogMgr + elapsed">{t}Reestimated Mgr{/t}</th>
               <th>{t}Elapsed{/t}</th>
               <th>{t}Backlog Mgr{/t}</th>
               <th style="width: 80px">{t}Drift Mgr{/t}</th>
            </tr>
            {foreach from=$versionsDetailedMgr key=name item=i name=versionsDetailedMgr}
               <tr {if $smarty.foreach.versionsDetailedMgr.last}class="row_total"{/if}>
                  <td>{$i.name}</td>
                  <td>{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td {$i.driftColor} title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsDetailed">
         {if $versionsDetailed}
         <table>
            <tr>
               <th>{t}Target version{/t}</th>
               <th>{t}EffortEstim{/t}</th>
               <th>{t}Reestimated{/t}</th>
               <th>{t}Elapsed{/t}</th>
               <th>{t}Backlog{/t}</th>
               <th style="width: 80px">{t}Drift{/t}</th>
            </tr>
            {foreach from=$versionsDetailed key=name item=i name=versionsDetailed}
               <tr {if $smarty.foreach.versionsDetailed.last}class="row_total"{/if}>
                  <td>{$i.name}</td>
                  <td {$i.title}>{$i.effortEstim}</td>
                  <td>{$i.reestimated}</td>
                  <td>{$i.elapsed}</td>
                  <td>{$i.backlog}</td>
                  <td {$i.driftColor} title="{t}nb days{/t}">{$i.drift}</td>
               </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabVersionsIssues">
         {if $versionsIssues}
         <table>
            <tr>
               <th>{t}Target version{/t}</th>
               <th>{t}New Tasks{/t}</th>
               <th>{t}Current Tasks{/t}</th>
               <th>{t}Resolved Tasks{/t}</th>
            </tr>
            {foreach from=$versionsIssues key=name item=i}
               <tr>
                  <td>{$i.name}</td>
                  <td>{$i.newList}</td>
                  <td>{$i.openList}</td>
                  <td>{$i.resolvedList}</td>
               </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
   </div>
   {/if}
   {if $currentIssuesInDrift || $resolvedIssuesInDrift}
   <h3 style="margin-top: 2em">{t}Tasks in drift{/t}</h3>
   <div id="tabsDrift" class="tabs">
      <ul>
         <li><a href="#tabCurrentDrift">{t}Drift current tasks{/t}</a></li>
         <li><a href="#tabResolvedDrift">{t}Drift resolved tasks{/t}</a></li>
      </ul>
      <div id="tabCurrentDrift">
         {if $currentIssuesInDrift}
         <table>
            <!--<caption>{t}Tasks in drift{/t}</caption>-->
            <tr>
               <th>{t}ID{/t}</th>
               <th>{t}Project{/t}</th>
               <th>{t}Target{/t}</th>
               {if $isManager}<th title="{t}Drift relatively to the managers Estimation{/t}">{t}Drift Mgr{/t}</th>{/if}
               <th title="{t}Drift relatively to (EE + AddEE){/t}">{t}Drift{/t}</th>
               <th>{t}RAF{/t}</th>
               <th>{t}Progress{/t}</th>
               <th>{t}Status{/t}</th>
               <th>{t}Summary{/t}</th>
            </tr>
            {foreach from=$currentIssuesInDrift key=name item=i}
            <tr>
               <td>{$i.mantisURL} {$i.issueURL}</td>
               <td>{$i.projectName}</td>
               <td>{$i.targetVersion}</td>
               {if $isManager}<td {$i.driftMgrColor}>{$i.driftMgr}</td>{/if}
               <td {$i.driftColor}>{$i.drift}</td>
               <td>{$i.backlog}</td>
               <td>{$i.progress}%</td>
               <td>{$i.currentStatusName}</td>
               <td>{$i.summary}</td>
            </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
      <div id="tabResolvedDrift">
         {if $resolvedIssuesInDrift}
         <table>
            <!--<caption>{t}Tasks in drift{/t}</caption>-->
            <tr>
               <th>{t}ID{/t}</th>
               <th>{t}Project{/t}</th>
               <th>{t}Target{/t}</th>
               {if $isManager}<th title="{t}Drift relatively to the managers Estimation{/t}">{t}Drift Mgr{/t}</th>{/if}
               <th title="{t}Drift relatively to (EE + AddEE){/t}">{t}Drift{/t}</th>
               <th>{t}RAF{/t}</th>
               <th>{t}Progress{/t}</th>
               <th>{t}Status{/t}</th>
               <th>{t}Summary{/t}</th>
            </tr>
            {foreach from=$resolvedIssuesInDrift key=name item=i}
               <tr>
                  <td>{$i.mantisURL} {$i.issueURL}</td>
                  <td>{$i.projectName}</td>
                  <td>{$i.targetVersion}</td>
                  {if $isManager}<td {$i.driftMgrColor}>{$i.driftMgr}</td>{/if}
                  <td {$i.driftColor}>{$i.drift}</td>
                  <td>{$i.backlog}</td>
                  <td>{$i.progress}%</td>
                  <td>{$i.currentStatusName}</td>
                  <td>{$i.summary}</td>
               </tr>
            {/foreach}
         </table>
         {else}
         {t}No data{/t}
         {/if}
      </div>
   </div>
   {/if}
   {if $error}
   <p style="text-align: center">{t}{$error}{/t}</div>
   {/if}
</div>
